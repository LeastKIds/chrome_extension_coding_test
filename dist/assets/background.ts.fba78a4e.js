chrome.runtime.onMessage.addListener(function(a,n,r){if(a.type==="login"){console.log("Login message received");const o=a.data.TOKEN;let e=!1;return fetch("https://api.github.com/user",{headers:{Authorization:`Bearer ${o}`}}).then(t=>t.json()).then(t=>{const s=t.login;chrome.storage.sync.set({USER:s},function(){if(chrome.runtime.lastError){e||(r({status:!1,data:{errMessage:chrome.runtime.lastError.message}}),e=!0);return}console.log("Saved user name"),e||(r({status:!0,data:{USER:s}}),e=!0)})}).catch(t=>{e||(r({status:!1,data:{errMessage:t.toString()}}),e=!0)}),!0}});
